<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3D Model Viewer</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>

    html, body {
  overflow-x: hidden;
}

    body {
      margin: 0;
      background-color: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100svh;
      overflow-y: hidden;
    }

    model-viewer {
      width: 100%;
      /* max-width: 600px; */
      height: 800px;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

        .btn-circle {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      padding: 0;
      border: none;
    }
  </style>
</head>
<body>


<div class="container-fluid min-vh-100 d-flex flex-column ">
    
<!-- Top Section: Logo, Name, and Vertical Buttons -->
<div class="d-flex justify-content-between align-items-start px-3 pt-5 ">

  <!-- Left: Logo Image -->
  <div>
    <img src="Nissan_2020_logo.svg" alt="Logo" style="height: 150px;">
  </div>

  <!-- Center: Car Name -->
  <div class="flex-grow-1 text-center">
    <h1 class="mb-0">Nissan X-Trial</h1>
  </div>

  <!-- Right: Vertical Buttons -->
  <div class="d-flex flex-column align-items-end">
    <button class="btn btn-dark mb-2">AR View</button>
    <button class="btn btn-dark" onclick="launchAR()">Interior</button>
  </div>

</div>


<div class="flex-grow-1 d-flex justify-content-center align-items-center ">
    <model-viewer
    id="carModel"
    src="untitled.glb"
    
    alt="3D model of Sitar Buckss"
    ar
    ar-modes="scene-viewer quick-look webxr"
    camera-controls
    auto-rotate
    shadow-intensity="1"
    touch-action="pan-y"
    ></model-viewer>

</div>

      <!-- Bottom: 5 Buttons -->
    <div class="d-flex justify-content-center gap-3">
      <button class="btn btn-circle" style="background-color: #bfbfbe; color: white;" onclick="changeBodyColor('#F4F5F1', 'brilliant white')"></button>
      <button class="btn btn-circle" style="background-color: #101030; color: white;" onclick="changeBodyColor('#15153101030d', 'blue')"></button>
      <button class="btn btn-circle" style="background-color: #80430f; color: white;" onclick="changeBodyColor('#351a03', 'orange')"></button>
      <button class="btn btn-circle" style="background-color: #520b0b; color: white;" onclick="changeBodyColor('#2e0606', 'red')"></button>
      <button class="btn btn-circle" style="background-color: #030802; color: white;" onclick="changeBodyColor('#030802', 'military green')"></button>
      <button class="btn btn-circle" style="background-color: #292929; color: white;" onclick="changeBodyColor('#292929', 'new silver')"></button>
      <button class="btn btn-circle" style="background-color: #241605; color: white;" onclick="changeBodyColor('#241605', 'dark brown')"></button>
            <button class="btn btn-circle" style="background-color: #292929; color: white;" onclick="changeBodyColor('#141414', 'new silver')"></button>
      <button class="btn btn-circle" style="background-color: #070606; color: white;" onclick="changeBodyColor('#070606', 'pearl black')"></button>

      

    </div>

    <div class="d-flex justify-content-center gap-3 mb-3">
      <div class="selected-color" id="selectedColorText">Orange</div>
    </div>
</div>



<script>
  const modelViewer = document.getElementById('carModel');
  const selectedColorText = document.getElementById('selectedColorText');
  const BODY_MATERIAL_NAME = 'Car_Paint'; // Change to your body material name if needed

      function launchAR() {
      const modelViewer = document.getElementById('carModel');
      modelViewer.activateAR();
    }

  // Convert hex color to normalized [r, g, b, a]
  function hexToRgbaArray(hex) {
    const bigint = parseInt(hex.replace('#', ''), 16);
    const r = ((bigint >> 16) & 255) / 255;
    const g = ((bigint >> 8) & 255) / 255;
    const b = (bigint & 255) / 255;
    return [r, g, b, 1];
  }

  async function changeBodyColor(hexColor, colorName) {
    await modelViewer.updateComplete;

    const materials = modelViewer.model?.materials;
    if (!materials) {
      console.warn("No materials found.");
      return;
    }

    const bodyMaterial = materials.find(mat => mat.name === BODY_MATERIAL_NAME);
    if (!bodyMaterial) {
      console.warn(`Material '${BODY_MATERIAL_NAME}' not found.`);
      return;
    }

    const rgba = hexToRgbaArray(hexColor);
    bodyMaterial.pbrMetallicRoughness.setBaseColorFactor(rgba);

    // Update displayed color name
    selectedColorText.textContent = `${colorName}`;
  }

  // On model load: log materials + apply default color
  modelViewer.addEventListener('load', () => {
    // Log material names to console
    console.log('Loaded materials:');
    modelViewer.model.materials.forEach(m => console.log(m.name));

    // âœ… Set initial color (change this color and name as needed)
    changeBodyColor('#351a03', 'orange'); // Red by default
  });
</script>

</body>
</html>

